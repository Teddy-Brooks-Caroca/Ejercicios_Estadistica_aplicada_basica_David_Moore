Casada = c(pct_18_24_casada,pct_40_64_casada),
Viuda = c(pct_18_24_viuda,pct_40_64_viuda),
Divorciada = c(pct_18_24_divorciada,pct_40_64_divorciada)
)
print(porcentajes_grupos)
matrix_4x4 <- matrix_mujeres[1:4,1:4]
matix_4x4
matrix_4x4 <- matrix_mujeres[1:4,1:4]
matrix_4x4
matrix_4x4 <- matrix_mujeres[1:4,1:4]
pct_por_edad <- round(prop.table(mat_4x4, margin = 1) * 100, 2)
matrix_4x4 <- matrix_mujeres[1:4,1:4]
pct_por_edad <- round(prop.table(matrix_4x4, margin = 1) * 100, 2)
pct_por_edad[c("18 a 24", "40 a 64"), ]
pct_solteras <- round(matrix_mujeres[1:4,1]/ matrix_mujeres[5,1] * 100,2)
pct_solteras
barplot(pct_solteras,
main = "Distribución de solteras por grupo etario",
ylab = "Porcentaje (%)",
col = c("lightblue", "lightgreen", "lightpink", "lightgray"),
ylim = c(0, 50))
grid()
matrix_dir_empresas <- matrix(c(480,120,
180,20),
nrow = 2, ncol = 2,
byrow = TRUE)
colnames(matrix_dir_empresas) = c("Admitido","No admitido")
rownames(matrix_dir_empresas) = c("Hombre","Mujer")
matrix_derecho <- matrix(c(10,90,
100,200),
nrow = 2, ncol = 2,
byrow = TRUE)
colnames(matrix_derecho) = c("Admitido","No admitido")
rownames(matrix_derecho) = c("Hombre","Mujer")
matrix_empresas_derecho = matrix_dir_empresas + matrix_derecho
print(matrix_empresas_derecho)
total_admitidos <- sum(matrix_empresas_derecho["Admitidos"])
total_admitidos
total_admitidos <- sum(matrix_empresas_derecho["Admitido"])
total_admitidos
total_admitidos <- sum(matrix_empresas_derecho[,"Admitido"])
total_admitidos
pct_admitidos <- round(prop.table(matrix_empresas_derecho, margin = 1) * 100, 2)
print(pct_admitidos["Admitido"])
pct_admitidos <- round(prop.table(matrix_empresas_derecho, margin = 1) * 100, 2)
print(pct_admitidos[,"Admitido"])
print(pasteO(pct_admitidos[,"Admitido"]),"%")
print(paste0(pct_admitidos[,"Admitido"]),"%")
print(paste0(pct_admitidos[,"Admitido"],"%"))
pct_admitidos <- round(prop.table(matrix_empresas_derecho, margin = 1) * 100, 2)
pct_sexo_admitidos <- data.frame(Sexo = rownames(pct_admitidos),
Porcentaje_Admitidos = paste0(pct_admitidos[,"Admitido"], "%"))
print(pct_sexo_admitidos)
total_admitidos_empresas <- sum(matrix_dir_empresas[,"Admitidos"])
total_admitidos_empresas <- sum(matrix_dir_empresas[,"Admitido"])
total_admitidos_derecho <- sum(matrix_derecho[,"Admitido"])
total_admitidos_empresas <- sum(matrix_dir_empresas[,"Admitido"])
total_admitidos_derecho <- sum(matrix_derecho[,"Admitido"])
pct_admitidos_empresas <- round(matrix_dir_empresas[,"Admitido"]/ total_admitidos_empresas * 100,2)
pct_admitidos_derecho <- round(matrix_derecho[,"Admitido"]/ total_admitidos_derecho * 100,2)
df_pct_admitidos <- data.frame(
Sexo = rownames(matrix_dir_empresas),
Empresas = paste0(pct_admitidos_empresas, "%"),
Derecho = paste0(pct_admitidos_derecho, "%")
)
print(df_pct_admitidos)
pct_admitidos_empresas <- round(matrix_dir_empresas[,"Admitido"]/ rowSums(matrix_dir_empresas) * 100,2)
pct_admitidos_derecho <- round(matrix_derecho[,"Admitido"]/ rowSums(matrix_derecho) * 100,2)
df_pct_admitidos <- data.frame(
Sexo = rownames(matrix_dir_empresas),
Empresas = paste0(pct_admitidos_empresas, "%"),
Derecho = paste0(pct_admitidos_derecho, "%")
)
print(df_pct_admitidos)
personas_enfermas <- data.frame(
Persona = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18),
Edad = c(29, 39, 44, 37, 42, 17, 38, 43, 51, 30, 32, 59, 33, 31, 32, 32, 36, 50),
Incubación = c(13, 46, 43, 34, 20, 20, 18, 72, 19, 36, 48, 44, 21, 32, 86, 48, 28, 16),
Resultado = c(0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0)
)
print(personas_enfermas)
plot(personas_enfermas$Incubación,
personas_enfermas$edad,
main = "Personas enfermas",
xlab = "Período de incubación (en horas)",
ylab = "Edad del paciente (en años)",
col = "blue",
pch = 16)
grid()
sobrevivieron <- personas_enfermas[personas_enfermas$Resultado == 0, ]
murieron <- personas_enfermas[personas_enfermas$Resultado == 1, ]
plot(personas_enfermas$Incubación,
personas_enfermas$edad,
main = "Personas enfermas",
xlab = "Período de incubación (en horas)",
ylab = "Edad del paciente (en años)")
points(sobrevivieron$Edad, sobrevivieron$Incubación,
pch = 16, col = "blue", cex = 1.2)
points(murieron$Edad, murieron$Incubación,
pch = 17, col = "red", cex = 1.2)
grid()
plot(personas_enfermas$Edad,
personas_enfermas$Incubación,
main = "Personas enfermas",
xlab = "Período de incubación (en horas)",
ylab = "Edad del paciente (en años)")
points(sobrevivieron$Edad, sobrevivieron$Incubación,
pch = 16, col = "blue", cex = 1.2)
points(murieron$Edad, murieron$Incubación,
pch = 17, col = "red", cex = 1.2)
grid()
plot(personas_enfermas$Edad,
personas_enfermas$Incubación,
main = "Personas enfermas",
xlab = "Edad del paciente (en años)",
ylab = "Período de incubación(en horas)")
points(sobrevivieron$Edad, sobrevivieron$Incubación,
pch = 16, col = "blue", cex = 1.2)
points(murieron$Edad, murieron$Incubación,
pch = 17, col = "red", cex = 1.2)
grid()
correlacion <- cor(personas_enfermas$Edad,personas_enfermas$Incubación, data = personas_enfermas)
correlacion <- cor(personas_enfermas$Edad,personas_enfermas$Incubación)
print(correlacion)
correlacion <- cor(personas_enfermas$Edad,personas_enfermas$Incubación)
print(paste0(round(correlacion * 100,2),"%"))
correlacion <- cor(personas_enfermas$Edad,personas_enfermas$Incubación)
print(correlacion)
correlacion_sobrevivieron <- cor(df$Edad[df$Resultado == 0], df$Incubación[df$Resultado == 0])
correlacion_sobrevivieron <- cor(personas_enfermas$Edad[personas_enfermas$Resultado == 0],
personas_enfermas$Incubación[personas_enfermas$Resultado == 0])
print(correlacion_sobrevivieron)
cor_edad <- cor(df$Edad, df$Resultado)
cor_edad <- cor(df$Edad, df$Resultado)
cor_edad <- cor(personas_enfermas$Edad, personas_enfermas$Resultado)
cor_incubacion <- cor(personas_enfermas$Incubación, personas_enfermas$Resultado)
resumen_correlaciones <- data.frame(
Correlaciones = c("Edad","Incubación"),
Resultado = c(cor_edad,cor_incubacion)
)
print(resumen_correlaciones)
resumen_correlaciones <- data.frame(
Correlaciones = c("Edad","Incubación"),
Resultado = c(round(cor_edad,3),round(cor_incubacion,3))
)
print(resumen_correlaciones)
media_edad <- mean(personas_enfermas$Edad)
media_inc  <- mean(personas_enfermas$Incubacion)
sd_edad <- sd(personas_enfermas$Edad)
sd_inc <- sd(personas_enfermas$Incubacion)
personas_enfermas$z_edad <- (personas_enfermas$Edad - mean_edad) / sd_edad
media_edad <- mean(personas_enfermas$Edad)
media_inc  <- mean(personas_enfermas$Incubacion)
sd_edad <- sd(personas_enfermas$Edad)
sd_inc <- sd(personas_enfermas$Incubacion)
personas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_inc  <- (personas_enfermas$Incubacion - media_inc) / sd_inc
media_edad <- mean(personas_enfermas$Edad)
media_inc  <- mean(personas_enfermas$Incubacion)
sd_edad <- sd(personas_enfermas$Edad)
sd_inc <- sd(personas_enfermas$Incubacion)
personas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_inc  <- (personas_enfermas$Incubación - media_inc) / sd_inc
umbral_z <- 3
out_edad <- personas_enfermas[abs(personas_enfermas$z_edad) > umbral_z, c("Persona","Edad","z_edad","Resultado")]
out_inc  <- personas_enfermas[abs(personas_enfermas$z_inc)  > umbral_z, c("Persona","Incubacion","z_inc","Resultado")]
media_edad <- mean(personas_enfermas$Edad)
media_inc  <- mean(personas_enfermas$Incubacion)
sd_edad <- sd(personas_enfermas$Edad)
sd_inc <- sd(personas_enfermas$Incubacion)
personas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_inc  <- (personas_enfermas$Incubación - media_inc) / sd_inc
umbral_z <- 3
out_edad <- personas_enfermas[abs(personas_enfermas$z_edad) > umbral_z, c("Persona","Edad","z_edad","Resultado")]
out_inc  <- personas_enfermas[abs(personas_enfermas$z_inc)  > umbral_z, c("Persona","Incubación","z_inc","Resultado")]
outliers_df <- data.frame(
Variable = c(rep("Edad", nrow(out_edad)), rep("Incubación", nrow(out_inc))),
Persona = c(out_edad$Persona, out_inc$Persona),
Valor = c(out_edad$Edad, out_inc$Incubación),
Z_Score = c(z_edad[abs(z_edad) > umbral], z_incubacion[abs(z_incubacion) > umbral_z])
)
ersonas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_inc  <- (personas_enfermas$Incubación - media_inc) / sd_inc
outliers_df <- data.frame(
Variable = c(rep("Edad", nrow(out_edad)), rep("Incubación", nrow(out_inc))),
Persona = c(out_edad$Persona, out_inc$Persona),
Valor = c(out_edad$Edad, out_inc$Incubación),
Z_Score = c(z_edad[abs(z_edad) > umbral], z_incubacion[abs(z_incubacion) > umbral_z])
)
print(personas_enfermas)
# Calcular z-scores corregido
media_edad <- mean(personas_enfermas$Edad)
media_inc <- mean(personas_enfermas$Incubación)  # Corregí el nombre
sd_edad <- sd(personas_enfermas$Edad)
sd_inc <- sd(personas_enfermas$Incubación)
personas_enfermas$z_edad <- (personas_enfermas$Edad - media_edad) / sd_edad
personas_enfermas$z_inc <- (personas_enfermas$Incubación - media_inc) / sd_inc
umbral_z <- 2  # Usualmente se usa 2 o 2.5 para datasets pequeños
out_edad <- personas_enfermas[abs(personas_enfermas$z_edad) > umbral_z, ]
out_inc <- personas_enfermas[abs(personas_enfermas$z_inc) > umbral_z, ]
cat("Outliers en Edad:\n")
print(out_edad[, c("Persona", "Edad", "z_edad", "Resultado")])
cat("\nOutliers en Incubación:\n")
print(out_inc[, c("Persona", "Incubación", "z_inc", "Resultado")])
outliers_combinado <- rbind(
data.frame(Variable = "Edad",
Persona = out_edad$Persona,
Valor = out_edad$Edad,
Z_Score = out_edad$z_edad,
Resultado = out_edad$Resultado),
data.frame(Variable = "Incubación",
Persona = out_inc$Persona,
Valor = out_inc$Incubación,
Z_Score = out_inc$z_inc,
Resultado = out_inc$Resultado)
)
print(outliers_combinado)
matrix_aspirina <- matrix(c(10,26,
129,213,
119,98),
nrow = 3, ncol = 2,
byrow = TRUE)
rownames(matrix_aspirina) = c("Ataques mortales","Otros ataques corazón","Embolias")
colnames(matrix_aspirina) = c("Grupo aspirina","Grupo Placebo")
print(matrix_aspirina)
matrix_aspirina[1,1]
matrix_aspirina <- matrix(c(10,26,36,
129,213,342,
119,98,217,
11037,11034,22071),
nrow = 4, ncol = 3,
byrow = TRUE)
rownames(matrix_aspirina) = c("Ataques mortales","Otros ataques corazón","Embolias","Total pacientes")
colnames(matrix_aspirina) = c("Grupo aspirina","Grupo Placebo","Total")
print(matrix_aspirina)
matrix_aspirina[4,1]
prc_mortal_aspirina <- (matrix_aspirina[1,1] / matrix_aspirina[4,1]) * 100
prc_otros_aspirina <- (matrix_aspirina[2,1] / matrix_aspirina[4,1]) * 100
prc_embolia_aspirina <- (matrix_aspirina[3,1] / matrix_aspirina[4,1]) * 100
prc_mortal_placebo <- (matrix_aspirina[1,2] / matrix_aspirina[4,2]) * 100
prc_otros_placebo <- (matrix_aspirina[2,2] / matrix_aspirina[4,2]) * 100
prc_embolia_placebo <- (matrix_aspirina[3,2] / matrix_aspirina[4,2]) * 100
prc_marginales <- data.frame(
Evento = c("Ataques mortales","Otros ataques corazón","Embolias"),
Grupo_aspirina = c(paste0(round(prc_mortal_aspirina,2),"%"),
paste0(round(prc_otros_aspirina,2),"%"),
paste0(round(prc_embolia_aspirina,2),"%")),
Grupo_placebo = c(paste0(round(prc_mortal_placebo,2),"%"),
paste0(round(prc_otros_placebo,2),"%"),
paste0(round(prc_embolia_placebo,2),"%"))
)
print(prc_marginales)
matrix_suicidios <- matrix(c(16381,2559,
3569,2110,
3824,803,
1641,623),
nrow = 4, ncol = 3,
byrow = TRUE)
colnames(matrix_suicidios) = c("Método","Hombres","Mujeres")
rownames(matrix_suicidios) = c("Arma de fuego","Veneno","Ahorcamiento","Otros")
print(matrix_suicidios)
matrix_suicidios <- matrix(c(16381,2559,
3569,2110,
3824,803,
1641,623),
nrow = 4, ncol = 2,
byrow = TRUE)
colnames(matrix_suicidios) = c("Método","Hombres","Mujeres")
matrix_suicidios <- matrix(c(16381,2559,
3569,2110,
3824,803,
1641,623),
nrow = 4, ncol = 2,
byrow = TRUE)
colnames(matrix_suicidios) = c("Hombres","Mujeres")
rownames(matrix_suicidios) = c("Arma de fuego","Veneno","Ahorcamiento","Otros")
print(matrix_suicidios)
total_hombres <- sum(matrix_suicidios[1:4,1])
print(total_hombres)
total_mujeres <- sum(matrix_suicidios[1:4,2])
total_poblacion <- total_hombres + total_mujeres
print(total_poblacion)
hombre_arma <- (matrix_suicidios[1,1] / total_poblacion) * 100
print(hombre_arma)
hombre_arma <- (matrix_suicidios[1,1] / total_hombres) * 100
print(hombre_arma)
poblacion <- 520
muestra <- 100
respondieron <- 48
no_respondieron <- muestra - respondieron
prc_respondieron <- (respondieron / poblacion) * 100
prc_no_respondieron <- (no_respondieron / poblacion) * 100
prc_estudio <- data.frame(
muestra_poblacional = c("Respondieron","No respondieron"),
porcentajes = c(paste0(round(prc_respondieron,2),"%"),
paste0(round(prc_no_respondieron,2),"%"))
)
print(prc_estudio)
poblacion <- 520
muestra <- 100
respondieron <- 48
no_respondieron <- muestra - respondieron
prc_respondieron <- (respondieron / muestra) * 100
prc_no_respondieron <- (no_respondieron / muestra) * 100
prc_estudio <- data.frame(
muestra_poblacional = c("Respondieron","No respondieron"),
porcentajes = c(paste0(round(prc_respondieron,2),"%"),
paste0(round(prc_no_respondieron,2),"%"))
)
print(prc_estudio)
muestra_cartas <- 1128
oponen <- 871
aceptan <- muestra_cartas - oponen
prc_oponen <- (oponen / muestra_cartas) * 100
prc_aceptan <- (aceptan / muestra_cartas) * 100
resultados_muestrales <- data.frame(
Cartas = c("Aceptan","Se oponen"),
Porcentajes = c(paste0(round(prc_aceptan,2),"%"),
paste0(round(prc_oponen,2),"%"))
)
print(resultados_muestrales)
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
setwd("C:/Users/brook/OneDrive/Escritorio/Portafolio/Ejercicios_Estadistica_aplicada_b-sica_David_Moore/Archivos")
tabla_b <- read.csv("Tabla_B_digitos_aleatorios.csv")
str(tabla_b)
options(scipen = 999)
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
#FACTURAS TRAMO MEDIO
tripletes_115 <- substring(linea_115,
seq(1, nchar(linea_115), 3),
seq(3, nchar(linea_115), 3))
numeros_estrato_medio <- as.numeric(tripletes_115)
facturas_medias <- numeros_estrato_medio[numeros_estrato_medio >= 1 & numeros_estrato_medio <= 500]
facturas_medias <- unique(facturas_medias)[1:5]
#FACTURAS TRAMO BAJO
cuatro_115 <- substring(linea_115,
seq(1, nchar(linea_115), 4),
seq(4, nchar(linea_115), 4))
numeros_estrato_bajo <- as.numeric(cuatro_115)
facturas_bajas <- numeros_estrato_bajo[numeros_estrato_bajo >= 1 & numeros_estrato_bajo <= 4400]
facturas_bajas <- unique(facturas_bajas)[1:5]
resultados_auditoria <- data.frame(
Estrato = c(rep("Medio (1.000-50.000 €)", 5),
rep("Bajo (<1.000 €)", 5)),
Numero_Factura = c(facturas_medias, facturas_bajas)
)
print(resultados_auditoria)
print(linea_115)
tabla_b <- read.csv("Tabla_B_digitos_aleatorios.csv",
colClasses = c("numeric", "character"))
str(tabla_b)
#PARA ALUMNOS
linea_valida_101 <- tabla_b$Bloques[tabla_b$Linea == 101]
pares <- substring(linea_valida_101,
seq(1, nchar(linea_valida_101), 2),
seq(2, nchar(linea_valida_101), 2))
numeros <- as.numeric(pares)
numeros_validos_alumnos <- numeros[numeros >= 1 & numeros <= 30]
alumnos_seleccionados <- alumnos[unique(numeros_validos_alumnos)[1:4]]
alumnos <- c("Abel","Flores","Cordón","Cuevas","García",
"Huidobro","Melendres","Rodríguez","Jiménez","Gutiérrez",
"Jordana","David","Homero","Lamas","Domènech",
"Hoz","Elias","Huertas","Lerma","López",
"Miranda","Nevia","Otero","Perales","Santos",
"Suárez","Telias","Torla","Portabella","Varga")
profesores <- c("Artero","Estapé","Lezama","Moravia","Satorra",
"Borrell","García","Lightman","Pericales","Yang")
tabla_b <- read.csv("Tabla_B_digitos_aleatorios.csv",
colClasses = c("numeric", "character"))
str(tabla_b)
#PARA ALUMNOS
linea_valida_101 <- tabla_b$Bloques[tabla_b$Linea == 101]
pares <- substring(linea_valida_101,
seq(1, nchar(linea_valida_101), 2),
seq(2, nchar(linea_valida_101), 2))
numeros <- as.numeric(pares)
numeros_validos_alumnos <- numeros[numeros >= 1 & numeros <= 30]
alumnos_seleccionados <- alumnos[unique(numeros_validos_alumnos)[1:4]]
print(alumnos_seleccionados)
#PARA PROFESORES
linea_103 <- tabla_b$Bloques[tabla_b$Linea == 103]
pares_103 <- substring(linea_103,
seq(1, nchar(linea_103), 2),
seq(2, nchar(linea_103), 2))
numeros_profesores <- as.numeric(pares_103)
numeros_validos_profesores <- numeros_profesores[numeros_profesores >= 1 & numeros_profesores <= 10]
profesores_seleccionados <- profesores[unique(numeros_validos_profesores)[1:2]]
print(profesores_seleccionados)
delegacion <- data.frame(
Tipo = c(rep("Alumno", 4), rep("Profesor", 2)),
Apellido = c(alumnos_seleccionados, profesores_seleccionados)
)
print(delegacion)
facturas_tramo_medio <- (500 * 5) / 100
facturas_tramo_bajo <- (4400 * 1 ) / 100
cantidad_auditoria <- data.frame(
Tipo_tramo = c("Tramo medio","Tramo bajo"),
Cantidad = c(facturas_tramo_medio,facturas_tramo_bajo)
)
print(cantidad_auditoria)
"
Tipo_tramo Cantidad
1 Tramo medio       25
2  Tramo bajo       44
===========================
Estrato alto no requiere muestreo, porque se va a revisar en su totalidad
"
# (b) Utiliza la tabla B, comenzando en la línea 115, para seleccionar sólo
# las primeras 5 facturas de cada uno de estos estratos.
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
#FACTURAS TRAMO MEDIO
tripletes_115 <- substring(linea_115,
seq(1, nchar(linea_115), 3),
seq(3, nchar(linea_115), 3))
numeros_estrato_medio <- as.numeric(tripletes_115)
facturas_medias <- numeros_estrato_medio[numeros_estrato_medio >= 1 & numeros_estrato_medio <= 500]
facturas_medias <- unique(facturas_medias)[1:5]
#FACTURAS TRAMO BAJO
cuatro_115 <- substring(linea_115,
seq(1, nchar(linea_115), 4),
seq(4, nchar(linea_115), 4))
numeros_estrato_bajo <- as.numeric(cuatro_115)
facturas_bajas <- numeros_estrato_bajo[numeros_estrato_bajo >= 1 & numeros_estrato_bajo <= 4400]
facturas_bajas <- unique(facturas_bajas)[1:5]
resultados_auditoria <- data.frame(
Estrato = c(rep("Medio (1.000-50.000 €)", 5),
rep("Bajo (<1.000 €)", 5)),
Numero_Factura = c(facturas_medias, facturas_bajas)
)
print(resultados_auditoria)
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
linea_116 <- tabla_b$Bloques[tabla_b$Linea == 116]
#FACTURAS TRAMO MEDIO
tripletes_115 <- substring(linea_115,
seq(1, nchar(linea_115), 3),
seq(3, nchar(linea_115), 3))
numeros_estrato_medio <- as.numeric(tripletes_115)
facturas_medias <- numeros_estrato_medio[numeros_estrato_medio >= 1 & numeros_estrato_medio <= 500]
facturas_medias <- unique(facturas_medias)[1:5]
#FACTURAS TRAMO BAJO
cuatro_115 <- substring(linea_115,
seq(1, nchar(linea_115), 4),
seq(4, nchar(linea_115), 4))
cuatro_116 <- substring(linea_116,
seq(1, nchar(linea_116), 4),
seq(4, nchar(linea_116), 4))
numeros_estrato_bajo <- as.numeric(cuatro_115)
numeros_extra_bajo <- as.numeric(cuatro_116)
facturas_bajas <- numeros_estrato_bajo[numeros_estrato_bajo >= 1 & numeros_estrato_bajo <= 4400]
numeros_validos_extra <- numeros_extra_bajo[numeros_extra_bajo >= 1 & numeros_extra_bajo <= 4400]
todos_bajos <- unique(c(facturas_bajas[!is.na(facturas_bajas)], numeros_validos_extra))[1:5]
resultados_auditoria$Numero_Factura[6:10] <- todos_bajos
resultados_auditoria <- data.frame(
Estrato = c(rep("Medio (1.000-50.000 €)", 5),
rep("Bajo (<1.000 €)", 5)),
Numero_Factura = c(facturas_medias, facturas_bajas)
)
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
linea_116 <- tabla_b$Bloques[tabla_b$Linea == 116]
#FACTURAS TRAMO MEDIO
tripletes_115 <- substring(linea_115,
seq(1, nchar(linea_115), 3),
seq(3, nchar(linea_115), 3))
numeros_estrato_medio <- as.numeric(tripletes_115)
facturas_medias <- numeros_estrato_medio[numeros_estrato_medio >= 1 & numeros_estrato_medio <= 500]
facturas_medias <- unique(facturas_medias)[1:5]
#FACTURAS TRAMO BAJO
cuatro_115 <- substring(linea_115,
seq(1, nchar(linea_115), 4),
seq(4, nchar(linea_115), 4))
cuatro_116 <- substring(linea_116,
seq(1, nchar(linea_116), 4),
seq(4, nchar(linea_116), 4))
numeros_estrato_bajo <- as.numeric(cuatro_115)
numeros_extra_bajo <- as.numeric(cuatro_116)
facturas_bajas <- numeros_estrato_bajo[numeros_estrato_bajo >= 1 & numeros_estrato_bajo <= 4400]
numeros_validos_extra <- numeros_extra_bajo[numeros_extra_bajo >= 1 & numeros_extra_bajo <= 4400]
todos_bajos <- unique(c(facturas_bajas[!is.na(facturas_bajas)], numeros_validos_extra))[1:5]
resultados_auditoria <- data.frame(
Estrato = c(rep("Medio (1.000-50.000 €)", 5),
rep("Bajo (<1.000 €)", 5)),
Numero_Factura = c(facturas_medias, facturas_bajas)
)
linea_115 <- tabla_b$Bloques[tabla_b$Linea == 115]
linea_116 <- tabla_b$Bloques[tabla_b$Linea == 116]
#FACTURAS TRAMO MEDIO
tripletes_115 <- substring(linea_115,
seq(1, nchar(linea_115), 3),
seq(3, nchar(linea_115), 3))
numeros_estrato_medio <- as.numeric(tripletes_115)
facturas_medias <- numeros_estrato_medio[numeros_estrato_medio >= 1 & numeros_estrato_medio <= 500]
facturas_medias <- unique(facturas_medias)[1:5]
#FACTURAS TRAMO BAJO
cuatro_115 <- substring(linea_115,
seq(1, nchar(linea_115), 4),
seq(4, nchar(linea_115), 4))
cuatro_116 <- substring(linea_116,
seq(1, nchar(linea_116), 4),
seq(4, nchar(linea_116), 4))
numeros_estrato_bajo <- as.numeric(cuatro_115)
numeros_extra_bajo <- as.numeric(cuatro_116)
facturas_bajas <- numeros_estrato_bajo[numeros_estrato_bajo >= 1 & numeros_estrato_bajo <= 4400]
numeros_validos_extra <- numeros_extra_bajo[numeros_extra_bajo >= 1 & numeros_extra_bajo <= 4400]
todos_bajos <- unique(c(facturas_bajas[!is.na(facturas_bajas)], numeros_validos_extra))[1:5]
resultados_auditoria <- data.frame(
Estrato = c(rep("Medio (1.000-50.000 €)", 5),
rep("Bajo (<1.000 €)", 5)),
Numero_Factura = c(facturas_medias, todos_bajos)
)
print(resultados_auditoria)
